<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>evolu.space â€” Login / Signup</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:'Inter',sans-serif; }
body {
  height:100vh; display:flex; justify-content:center; align-items:center;
  background: linear-gradient(135deg, #ffb6c1, #ff69b4);
  overflow:hidden; perspective:1000px;
}
.card {
  background: rgba(255,255,255,0.15); backdrop-filter: blur(20px);
  border-radius:25px; padding:40px 35px; width:360px; text-align:center;
  box-shadow:0 10px 35px rgba(0,0,0,0.2); transition: transform 0.15s ease-out;
}
h1 { font-size:2rem; color:#fff; margin-bottom:20px; text-shadow:0 3px 10px rgba(0,0,0,0.2); }

.tabs { display:flex; justify-content:center; margin-bottom:20px; gap:10px; }
.tabs button {
  flex:1; padding:10px; border:none; border-radius:12px; cursor:pointer;
  font-weight:600; background: rgba(255,255,255,0.2); color:#fff; transition:all 0.3s;
}
.tabs button.active { background:#fff; color:#ff69b4; }

form { display:none; flex-direction:column; gap:12px; }
form.active { display:flex; }

input {
  padding:12px; border:none; border-radius:12px; outline:none;
  background: rgba(255,255,255,0.2); color:#fff; font-size:1rem;
}
input::placeholder { color:rgba(255,255,255,0.7); }

button.submit {
  padding:12px; border:none; border-radius:12px; background:#fff;
  font-weight:bold; color:#ff69b4; cursor:pointer; transition: all 0.3s;
}
button.submit:hover { background:#ffe0f0; transform: translateY(-2px); }

.message {
  margin-top:10px; font-weight:600; padding:8px; border-radius:10px; display:none;
}
.message.success { background: rgba(0,255,150,0.8); color:#fff; }
.message.error { background: rgba(255,50,50,0.8); color:#fff; }

body::before {
  content:""; position: fixed; top:-50%; left:-50%; width:200%; height:200%;
  background: radial-gradient(circle at center, rgba(255,255,255,0.12), transparent 70%);
}
</style>
</head>
<body>
  <div class="card" id="card">
    <h1>evolu.space</h1>
    <div class="tabs">
      <button id="login-tab" class="active">Login</button>
      <button id="signup-tab">Sign Up</button>
    </div>

// Signup
signupForm.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const username = document.getElementById("signup-username").value;
  const email = document.getElementById("signup-email").value;
  const password = document.getElementById("signup-password").value;

  // Create user
  const { data: authData, error: authError } = await supabaseClient.auth.signUp({ email, password });
  if(authError) return showMessage(authError.message,"error");

  const user = authData.user;
  if(user) {
    // Insert profile with user.id
    const { error: profileError } = await supabaseClient.from("profiles").insert([
      { id: user.id, username, email }
    ]);
    if(profileError) return showMessage(profileError.message,"error");

    showMessage("Signup successful! Redirecting...","success");
    setTimeout(()=> window.location.href = "/" + username, 1000);
  }
});

// Login
loginForm.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const email = document.getElementById("login-email").value;
  const password = document.getElementById("login-password").value;

  const { data: authData, error } = await supabaseClient.auth.signInWithPassword({ email, password });
  if(error) return showMessage(error.message,"error");

  const user = authData.user;
  if(user) {
    const { data: profile } = await supabaseClient.from("profiles").select("username").eq("id", user.id).maybeSingle();
    if(profile) {
      showMessage("Login successful! Redirecting...","success");
      setTimeout(()=> window.location.href = "/" + profile.username, 1000);
    }
  }
});

// Supabase client
const supabaseClient = supabase.createClient(
  "https://ujhfseertgazpvqheepy.supabase.co", // replace
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVqaGZzZWVydGdhenB2cWhlZXB5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0MjI4NDUsImV4cCI6MjA3Mzk5ODg0NX0.hkFcKm7M0_yBI0jJ2y2WimLEiEtRstHPvUzC8q3yQck"                 // replace
);

// Elements
const loginTab = document.getElementById("login-tab");
const signupTab = document.getElementById("signup-tab");
const loginForm = document.getElementById("login-form");
const signupForm = document.getElementById("signup-form");
const messageEl = document.getElementById("message");

// Tab toggle
loginTab.onclick = () => {
  loginTab.classList.add("active");
  signupTab.classList.remove("active");
  loginForm.classList.add("active");
  signupForm.classList.remove("active");
};
signupTab.onclick = () => {
  signupTab.classList.add("active");
  loginTab.classList.remove("active");
  signupForm.classList.add("active");
  loginForm.classList.remove("active");
};

// Show messages
function showMessage(text, type="success") {
  messageEl.textContent = text;
  messageEl.className = `message ${type}`;
  messageEl.style.display = "block";
  setTimeout(()=> messageEl.style.display="none", 4000);
}

// Login
loginForm.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const email = document.getElementById("login-email").value;
  const password = document.getElementById("login-password").value;

  const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
  if(error) return showMessage(error.message,"error");

  const { data: profile } = await supabaseClient.from("profiles").select("username").eq("email", email).maybeSingle();
  if(profile) {
    showMessage("Login successful! Redirecting...","success");
    setTimeout(()=> window.location.href = "/" + profile.username, 1000);
  }
});

// Signup
signupForm.addEventListener("submit", async (e)=>{
  e.preventDefault();
  const username = document.getElementById("signup-username").value;
  const email = document.getElementById("signup-email").value;
  const password = document.getElementById("signup-password").value;

  const { error } = await supabaseClient.auth.signUp({ email, password });
  if(error) return showMessage(error.message,"error");

  await supabaseClient.from("profiles").insert([{ username, email }]);

  showMessage("Signup successful! Redirecting...","success");
  setTimeout(()=> window.location.href = "/" + username, 1000);
});

// Cursor parallax
const card = document.getElementById("card");
document.addEventListener("mousemove", e=>{
  const x = (window.innerWidth/2 - e.clientX)/20;
  const y = (window.innerHeight/2 - e.clientY)/20;
  card.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
});
</script>
</body>
</html>
