// LOGIN
if(user.password !== password){ 
  alert('❌ Incorrect password'); 
  return; 
}

// Check if static folder exists
fetch(`/users/${username}/profile.json`)
  .then(res => {
    if(res.ok){
      alert(`✅ Welcome back, ${user.name}! Redirecting...`);
      window.location.href = `/users/${username}/`;
    } else {
      alert("⚠️ Login successful, but your profile page doesn't exist yet.\nAsk the site owner to create /users/" + username);
    }
  })
  .catch(() => {
    alert("⚠️ Login successful, but your profile page doesn't exist yet.\nAsk the site owner to create /users/" + username);
  });


// SIGNUP
const signupForm = document.getElementById('signup-form');
if(signupForm){
  signupForm.addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('signup-username').value.trim();
    const password = document.getElementById('signup-password').value.trim();
    const email = document.getElementById('signup-email').value.trim();
    const name = document.getElementById('signup-name').value.trim();
    const profileImg = document.getElementById('signup-profile-img').value.trim();

    if(localStorage.getItem('user_' + username)){
      alert('❌ Username already exists');
      return;
    }

    localStorage.setItem('user_' + username, JSON.stringify({
      username, password, email, name, profileImg
    }));

    alert('✅ Account created! Logging you in...');
    window.location.href = `/users/${username}/`;
  });
}
